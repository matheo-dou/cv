<!DOCTYPE html>
<html lang="fr">
<head>
    <title>CV - Douillez Matheo</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>
<body>
  
  <div class="container">
      
      <header class="header">
        <h1>Mathéo Douillez</h1>
        <h2>Recherche Alternance - Cybersécurité</h2>
        <p>
            <strong>Disponibilités : </strong>Début Septembre 2026 (Rythme : 2 Semaines en entreprise, 1 semaine en cours)
        </p>
        <p><br></p>
        <p>née le 24/11/2006</p>
        <p>Email: matheo.douillez3@gmail.com</p>
        <p>Téléphone: 06 50 22 09 13</p>
        <p>Disponible dans le Secteur Haut de France</p>
      </header>
          
        <nav class="nav">
            <ul>
                <li><a href="#experiences">Expériences Professionnelles et Bénévolat</a></li>
                <li><a href="#competences">Compétences</a></li>
                <li><a href="#etudes">Études</a></li>
                <li><a href="#certifications">Diplômes et Certifications</a></li>
            </ul>
        </nav>
      
          <section id="experiences">
          <h3>Expériences Professionnelles et Bénévolat</h3>
          <ul id="experience-list"> 
          </ul>

              <script>
document.addEventListener('DOMContentLoaded', () => {
    const listContainer = document.getElementById('experience-list');
    
    // REMPLACER par le lien CSV PUBLIÉ de Google Sheets
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRlSc6vx6ZK0DHSEPw8bRr3a8KDHRwOQhFLB7njw5VxP2EgopqJY39YGhoFqfh83kwZNZ4Ml4wuYDIY/pubhtml?widget=true&amp;headers=false'; 

    // Fonction pour afficher les messages d'erreur directement sur la page
    function displayError(message) {
        listContainer.innerHTML = `<li style="color: red; background-color: #ffe6e6; padding: 10px; border-radius: 5px;">
            ⚠️ ERREUR : ${message}
            <br><small style="color: #666;">Vérifiez que le lien Google Sheets est bien en mode PUBLICATION (.csv) et que le format des colonnes (id, poste, etc.) est exact.</small>
        </li>`;
    }

    fetch(csvUrl)
        .then(response => {
            if (!response.ok) {
                // Erreur de réseau ou 404/403 (URL non trouvée ou CORS bloqué)
                throw new Error(`Échec du chargement (Statut: ${response.status}). Vérifiez l'URL de publication.`);
            }
            return response.text();
        })
        .then(csvText => {
            const data = csvToJSON(csvText);

            if (data.length === 0) {
                 // Si le CSV est lu mais qu'aucune ligne valide n'est trouvée (possible si headers seulement)
                return displayError("Aucune donnée d'expérience valide n'a été trouvée dans le fichier CSV.");
            }
            
            // Tri par ID décroissant (le plus grand ID en premier)
            data.sort((a, b) => {
                // S'assure de trier numériquement même si l'ID est une chaîne
                return parseInt(b.id || 0) - parseInt(a.id || 0); 
            });

            // Affichage des données triées
            data.forEach(item => {
                const listItem = document.createElement('li');
                
                listItem.innerHTML = `
                    <div class="item-title">${item.poste || 'Titre manquant'}<span class="item-date">${item.date || ''}</span></div>
                    <div class="item-subtitle">${item.entreprise || ''}</div>
                    <p class="item-description">${item.description || ''}</p>
                `;
                
                listContainer.appendChild(listItem);
            });
        })
        .catch(error => {
            // Affiche l'erreur si elle a été lancée par 'fetch' ou par le 'throw'
            displayError(error.message || "Problème général de traitement ou de réseau.");
        });


    // FONCTION DE CONVERSION CSV VERS JSON
    function csvToJSON(csv) {
        const lines = csv.split('\n');
        // Vérifie qu'il y a au moins une ligne d'en-tête
        if (lines.length < 2) return []; 
        
        const headers = lines[0].split(',');
        const result = [];
        
        for (let i = 1; i < lines.length; i++) {
            if (!lines[i].trim()) continue;
            
            const currentline = lines[i].split(',');
            const obj = {};
            
            // Assurez-vous que les colonnes correspondent
            if (currentline.length < headers.length) continue; 
            
            for (let j = 0; j < headers.length; j++) {
                let key = headers[j].trim().replace(/['"]+/g, '');
                let value = currentline[j] ? currentline[j].trim().replace(/['"]+/g, '') : '';
                obj[key] = value;
            }
            
            // Ligne de vérification de l'ID : seulement si l'ID est un nombre > 0
            const idNumber = parseInt(obj.id);
            if (!isNaN(idNumber) && idNumber > 0) {
                result.push(obj);
            }
        }
        return result;
    }
});
              </script>
              
              
      </section>
    
      <section id="competences">
          <h3>Compétences</h3>
          <ul class="skills-list">
             <li>Débutant en Programmation WEB: HTML, CSS, PHP, JS</li>
             <li>Débutant en Programmation Logiciel : CPP, Python</li>
             <li>Gestion et Sécurisation de Réseau informatique :  expérience principale en simulation avec GNS3, Cisco</li>
          </ul>
      </section>

      <section id="etudes">
          <h3>Études</h3>
          <ul>
              <li>
                  <div class="item-title">Seconde Professionnelle TNE (Transition Numérique et Énergétique)
                      <span class="item-date">2021 - 2022</span></div>
                  <div class="item-subtitle">Lycée Ferry, Arras 62000</div>
              </li>
              <li>
                  <div class="item-title">Première Professionnelle Système Numérique Option ARED (Audiovisuel, Réseaux informatique, Équipements domestique)
                      <span class="item-date">2022 - 2023</span></div>
                  <div class="item-subtitle">Lycée Ferry, Arras 62000</div>
              </li>
              <li>
                  <div class="item-title">Terminale Professionnelle Système Numérique Option ARED (Audiovisuel, Réseaux informatique, Équipements domestique)
                      <span class="item-date">2023 - 2024</span></div>
                  <div class="item-subtitle">Lycée Ferry, Arras 62000</div>
              </li>
              <li>
                  <div class="item-title">Première année de BTS CIEL (Cybersecurité, informatique et réseaux, électronique)
                      <span class="item-date">2024 - 2025</span></div>
                  <div class="item-subtitle">Lycée André Malraux, Béthune 62400</div>
              </li>
              <li>
                  <div class="item-title">Seconde année de BTS CIEL (Cybersecurité, informatique et réseaux, électronique)
                      <span class="item-date">2025 - 2026</span></div>
                  <div class="item-subtitle">Lycée André Malraux, Béthune 62400</div>
              </li>
              </ul>
          </section>

      <section id="certifications">
          <h3>Diplômes et Certifications</h3>
          <ul>
              <li>
                  <div class="item-title">Baccalauréat Professionnel Système Numérique Option ARED (Audiovisuel, Réseaux informatique, Équipements domestique)
                      <span class="item-date">2024</span></div>
              </li>
          </ul>
          </section>

      <footer class="footer">
          <p>&copy; 2025 Mathéo Douillez.</p>
      </footer>

  </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
  </body>
</html>
